| distributed init (rank 0): env://, gpu 0
Namespace(aa='rand-m7-n4-mstd0.5-inc1', attn_drop_rate=0.0, auto_resume=True, batch_size=4, clip_grad=None, color_jitter=0.4, crop_pct=None, cutmix=1.0, cutmix_minmax=None, data_path='/data/i5O/kinetics-dataset/annotations', data_root='/data/i5O/kinetics400/train/', data_set='Kinetics-400', deepscale=False, deepscale_config=None, deepspeed=False, deepspeed_config='OUTPUT/mvd_vit_small_with_vit_base_teacher_k400_epoch_400/finetune_on_k400/deepspeed_config.json', deepspeed_mpi=False, device='cuda', disable_eval_during_finetuning=False, dist_backend='nccl', dist_eval=True, dist_on_itp=False, dist_url='env://', distributed=True, drop=0.0, drop_path=0.1, enable_deepspeed=True, epochs=150, eval=False, eval_data_path=None, eval_log_name='log_eval', fc_drop_rate=0.0, finetune='/data/i5O/pretrained/mvd_s_from_b_ckpt_399.pth', gpu=0, imagenet_default_mean_and_std=True, init_scale=0.001, input_size=224, layer_decay=0.75, local_rank=0, log_dir='OUTPUT/mvd_vit_small_with_vit_base_teacher_k400_epoch_400/finetune_on_k400', lr=0.001, merge_test=False, min_lr=0.001, mixup=0.8, mixup_mode='batch', mixup_prob=1.0, mixup_switch_prob=0.5, model='vit_small_patch16_224', model_ema=False, model_ema_decay=0.9999, model_ema_force_cpu=False, model_key='model|module', model_prefix='', momentum=0.9, nb_classes=400, no_save_best_ckpt=True, num_frames=16, num_sample=2, num_segments=1, num_workers=4, opt='adamw', opt_betas=[0.9, 0.999], opt_eps=1e-08, output_dir='OUTPUT/mvd_vit_small_with_vit_base_teacher_k400_epoch_400/finetune_on_k400', pin_mem=True, rank=0, recount=1, remode='pixel', remove_pos_emb=False, reprob=0.25, resplit=False, resume='', resume_best=False, sampling_rate=4, save_ckpt=True, save_ckpt_freq=50, seed=0, short_side_size=224, smoothing=0.1, start_epoch=0, test_num_crop=3, test_num_segment=5, train_interpolation='bicubic', tubelet_size=2, update_freq=4, use_checkpoint=False, use_cls_token=False, use_mean_pooling=True, warmup_epochs=0, warmup_lr=0.001, warmup_steps=-1, weight_decay=0.05, weight_decay_end=None, world_size=1)
Patch size = (16, 16)
                                                        0    1
0       /data/i5O/kinetics400/train/-3B32lodo2M_000059...    0
1       /data/i5O/kinetics400/train/-7kbO0v4hag_000107...    0
2       /data/i5O/kinetics400/train/-bwYZwnwb8E_000013...    0
3       /data/i5O/kinetics400/train/-Cv3NwxG_8g_000087...    0
4       /data/i5O/kinetics400/train/-hLv_HL6UhY_000151...    0
...                                                   ...  ...
241202  /data/i5O/kinetics400/train/_GRX1r0JV30_000039...  399
241203  /data/i5O/kinetics400/train/_JuIL8GGX0A_000150...  399
241204  /data/i5O/kinetics400/train/_Jun6C7ICps_000037...  399
241205  /data/i5O/kinetics400/train/_SyAhrLns4k_000200...  399
241206  /data/i5O/kinetics400/train/_URmIF4eHg4_000014...  399

[241207 rows x 2 columns]
Number of the class = 400
                                                       0    1
0      /data/i5O/kinetics400/val/0wR5jVB-WPk_000417_0...    0
1      /data/i5O/kinetics400/val/3caPS4FHFF8_000036_0...    0
2      /data/i5O/kinetics400/val/3yaoNwz99xM_000062_0...    0
3      /data/i5O/kinetics400/val/6IbvOJxXnOo_000047_0...    0
4      /data/i5O/kinetics400/val/6_4kjPiQr7w_000191_0...    0
...                                                  ...  ...
19874  /data/i5O/kinetics400/val/w5hbJLVhZDI_000093_0...  399
19875  /data/i5O/kinetics400/val/xDd6uIBeMEA_000001_0...  399
19876  /data/i5O/kinetics400/val/XWvGn7eI04A_000012_0...  399
19877  /data/i5O/kinetics400/val/yGdQwxP5koA_000083_0...  399
19878  /data/i5O/kinetics400/val/ZVDR2od1gn8_000037_0...  399

[19879 rows x 2 columns]
Number of the class = 400
                                                       0    1
0      /data/i5O/kinetics400/val/0wR5jVB-WPk_000417_0...    0
1      /data/i5O/kinetics400/val/3caPS4FHFF8_000036_0...    0
2      /data/i5O/kinetics400/val/3yaoNwz99xM_000062_0...    0
3      /data/i5O/kinetics400/val/6IbvOJxXnOo_000047_0...    0
4      /data/i5O/kinetics400/val/6_4kjPiQr7w_000191_0...    0
...                                                  ...  ...
19874  /data/i5O/kinetics400/val/w5hbJLVhZDI_000093_0...  399
19875  /data/i5O/kinetics400/val/xDd6uIBeMEA_000001_0...  399
19876  /data/i5O/kinetics400/val/XWvGn7eI04A_000012_0...  399
19877  /data/i5O/kinetics400/val/yGdQwxP5koA_000083_0...  399
19878  /data/i5O/kinetics400/val/ZVDR2od1gn8_000037_0...  399

[19879 rows x 2 columns]
Number of the class = 400
Sampler_train = <torch.utils.data.distributed.DistributedSampler object at 0x7fed0a0eee20>
Mixup is activated!
Load ckpt from /data/i5O/pretrained/mvd_s_from_b_ckpt_399.pth
Load state_dict by model_key = model
Weights of VisionTransformer not initialized from pretrained model: ['fc_norm.weight', 'fc_norm.bias', 'head.weight', 'head.bias']
Weights from pretrained model not used in VisionTransformer: ['pos_embed', 'mask_token_img', 'pos_embed_img', 'mask_token_vid', 'pos_embed_vid', 'norm.weight', 'norm.bias']
Model = VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 384, kernel_size=(2, 16, 16), stride=(2, 16, 16))
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (blocks): ModuleList(
    (0): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (1): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.00909090880304575)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (2): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.0181818176060915)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (3): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.027272727340459824)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (4): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.036363635212183)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (5): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.045454543083906174)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (6): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.054545458406209946)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (7): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.06363636255264282)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (8): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.0727272778749466)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (9): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.08181818574666977)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (10): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.09090909361839294)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
    (11): Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): DropPath(p=0.10000000149011612)
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): Identity()
  (fc_norm): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
  (fc_dropout): Identity()
  (head): Linear(in_features=384, out_features=400, bias=True)
)
number of params: 22033936
LR = 0.00006250
Batch size = 16
Update frequent = 4
Number of training examples = 241207
Number of training training per epoch = 15075
Assigned values = [0.023757264018058777, 0.03167635202407837, 0.04223513603210449, 0.056313514709472656, 0.07508468627929688, 0.1001129150390625, 0.13348388671875, 0.177978515625, 0.2373046875, 0.31640625, 0.421875, 0.5625, 0.75, 1.0]
Skip weight decay list:  {'cls_token', 'pos_embed'}
Param groups = {
  "layer_0_decay": {
    "weight_decay": 0.05,
    "params": [
      "patch_embed.proj.weight"
    ],
    "lr_scale": 0.023757264018058777
  },
  "layer_0_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "patch_embed.proj.bias"
    ],
    "lr_scale": 0.023757264018058777
  },
  "layer_1_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.0.norm1.weight",
      "blocks.0.norm1.bias",
      "blocks.0.attn.q_bias",
      "blocks.0.attn.v_bias",
      "blocks.0.attn.proj.bias",
      "blocks.0.norm2.weight",
      "blocks.0.norm2.bias",
      "blocks.0.mlp.fc1.bias",
      "blocks.0.mlp.fc2.bias"
    ],
    "lr_scale": 0.03167635202407837
  },
  "layer_1_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.0.attn.qkv.weight",
      "blocks.0.attn.proj.weight",
      "blocks.0.mlp.fc1.weight",
      "blocks.0.mlp.fc2.weight"
    ],
    "lr_scale": 0.03167635202407837
  },
  "layer_2_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.1.norm1.weight",
      "blocks.1.norm1.bias",
      "blocks.1.attn.q_bias",
      "blocks.1.attn.v_bias",
      "blocks.1.attn.proj.bias",
      "blocks.1.norm2.weight",
      "blocks.1.norm2.bias",
      "blocks.1.mlp.fc1.bias",
      "blocks.1.mlp.fc2.bias"
    ],
    "lr_scale": 0.04223513603210449
  },
  "layer_2_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.1.attn.qkv.weight",
      "blocks.1.attn.proj.weight",
      "blocks.1.mlp.fc1.weight",
      "blocks.1.mlp.fc2.weight"
    ],
    "lr_scale": 0.04223513603210449
  },
  "layer_3_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.2.norm1.weight",
      "blocks.2.norm1.bias",
      "blocks.2.attn.q_bias",
      "blocks.2.attn.v_bias",
      "blocks.2.attn.proj.bias",
      "blocks.2.norm2.weight",
      "blocks.2.norm2.bias",
      "blocks.2.mlp.fc1.bias",
      "blocks.2.mlp.fc2.bias"
    ],
    "lr_scale": 0.056313514709472656
  },
  "layer_3_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.2.attn.qkv.weight",
      "blocks.2.attn.proj.weight",
      "blocks.2.mlp.fc1.weight",
      "blocks.2.mlp.fc2.weight"
    ],
    "lr_scale": 0.056313514709472656
  },
  "layer_4_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.3.norm1.weight",
      "blocks.3.norm1.bias",
      "blocks.3.attn.q_bias",
      "blocks.3.attn.v_bias",
      "blocks.3.attn.proj.bias",
      "blocks.3.norm2.weight",
      "blocks.3.norm2.bias",
      "blocks.3.mlp.fc1.bias",
      "blocks.3.mlp.fc2.bias"
    ],
    "lr_scale": 0.07508468627929688
  },
  "layer_4_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.3.attn.qkv.weight",
      "blocks.3.attn.proj.weight",
      "blocks.3.mlp.fc1.weight",
      "blocks.3.mlp.fc2.weight"
    ],
    "lr_scale": 0.07508468627929688
  },
  "layer_5_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.4.norm1.weight",
      "blocks.4.norm1.bias",
      "blocks.4.attn.q_bias",
      "blocks.4.attn.v_bias",
      "blocks.4.attn.proj.bias",
      "blocks.4.norm2.weight",
      "blocks.4.norm2.bias",
      "blocks.4.mlp.fc1.bias",
      "blocks.4.mlp.fc2.bias"
    ],
    "lr_scale": 0.1001129150390625
  },
  "layer_5_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.4.attn.qkv.weight",
      "blocks.4.attn.proj.weight",
      "blocks.4.mlp.fc1.weight",
      "blocks.4.mlp.fc2.weight"
    ],
    "lr_scale": 0.1001129150390625
  },
  "layer_6_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.5.norm1.weight",
      "blocks.5.norm1.bias",
      "blocks.5.attn.q_bias",
      "blocks.5.attn.v_bias",
      "blocks.5.attn.proj.bias",
      "blocks.5.norm2.weight",
      "blocks.5.norm2.bias",
      "blocks.5.mlp.fc1.bias",
      "blocks.5.mlp.fc2.bias"
    ],
    "lr_scale": 0.13348388671875
  },
  "layer_6_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.5.attn.qkv.weight",
      "blocks.5.attn.proj.weight",
      "blocks.5.mlp.fc1.weight",
      "blocks.5.mlp.fc2.weight"
    ],
    "lr_scale": 0.13348388671875
  },
  "layer_7_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.6.norm1.weight",
      "blocks.6.norm1.bias",
      "blocks.6.attn.q_bias",
      "blocks.6.attn.v_bias",
      "blocks.6.attn.proj.bias",
      "blocks.6.norm2.weight",
      "blocks.6.norm2.bias",
      "blocks.6.mlp.fc1.bias",
      "blocks.6.mlp.fc2.bias"
    ],
    "lr_scale": 0.177978515625
  },
  "layer_7_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.6.attn.qkv.weight",
      "blocks.6.attn.proj.weight",
      "blocks.6.mlp.fc1.weight",
      "blocks.6.mlp.fc2.weight"
    ],
    "lr_scale": 0.177978515625
  },
  "layer_8_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.7.norm1.weight",
      "blocks.7.norm1.bias",
      "blocks.7.attn.q_bias",
      "blocks.7.attn.v_bias",
      "blocks.7.attn.proj.bias",
      "blocks.7.norm2.weight",
      "blocks.7.norm2.bias",
      "blocks.7.mlp.fc1.bias",
      "blocks.7.mlp.fc2.bias"
    ],
    "lr_scale": 0.2373046875
  },
  "layer_8_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.7.attn.qkv.weight",
      "blocks.7.attn.proj.weight",
      "blocks.7.mlp.fc1.weight",
      "blocks.7.mlp.fc2.weight"
    ],
    "lr_scale": 0.2373046875
  },
  "layer_9_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.8.norm1.weight",
      "blocks.8.norm1.bias",
      "blocks.8.attn.q_bias",
      "blocks.8.attn.v_bias",
      "blocks.8.attn.proj.bias",
      "blocks.8.norm2.weight",
      "blocks.8.norm2.bias",
      "blocks.8.mlp.fc1.bias",
      "blocks.8.mlp.fc2.bias"
    ],
    "lr_scale": 0.31640625
  },
  "layer_9_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.8.attn.qkv.weight",
      "blocks.8.attn.proj.weight",
      "blocks.8.mlp.fc1.weight",
      "blocks.8.mlp.fc2.weight"
    ],
    "lr_scale": 0.31640625
  },
  "layer_10_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.9.norm1.weight",
      "blocks.9.norm1.bias",
      "blocks.9.attn.q_bias",
      "blocks.9.attn.v_bias",
      "blocks.9.attn.proj.bias",
      "blocks.9.norm2.weight",
      "blocks.9.norm2.bias",
      "blocks.9.mlp.fc1.bias",
      "blocks.9.mlp.fc2.bias"
    ],
    "lr_scale": 0.421875
  },
  "layer_10_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.9.attn.qkv.weight",
      "blocks.9.attn.proj.weight",
      "blocks.9.mlp.fc1.weight",
      "blocks.9.mlp.fc2.weight"
    ],
    "lr_scale": 0.421875
  },
  "layer_11_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.10.norm1.weight",
      "blocks.10.norm1.bias",
      "blocks.10.attn.q_bias",
      "blocks.10.attn.v_bias",
      "blocks.10.attn.proj.bias",
      "blocks.10.norm2.weight",
      "blocks.10.norm2.bias",
      "blocks.10.mlp.fc1.bias",
      "blocks.10.mlp.fc2.bias"
    ],
    "lr_scale": 0.5625
  },
  "layer_11_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.10.attn.qkv.weight",
      "blocks.10.attn.proj.weight",
      "blocks.10.mlp.fc1.weight",
      "blocks.10.mlp.fc2.weight"
    ],
    "lr_scale": 0.5625
  },
  "layer_12_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "blocks.11.norm1.weight",
      "blocks.11.norm1.bias",
      "blocks.11.attn.q_bias",
      "blocks.11.attn.v_bias",
      "blocks.11.attn.proj.bias",
      "blocks.11.norm2.weight",
      "blocks.11.norm2.bias",
      "blocks.11.mlp.fc1.bias",
      "blocks.11.mlp.fc2.bias"
    ],
    "lr_scale": 0.75
  },
  "layer_12_decay": {
    "weight_decay": 0.05,
    "params": [
      "blocks.11.attn.qkv.weight",
      "blocks.11.attn.proj.weight",
      "blocks.11.mlp.fc1.weight",
      "blocks.11.mlp.fc2.weight"
    ],
    "lr_scale": 0.75
  },
  "layer_13_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "fc_norm.weight",
      "fc_norm.bias",
      "head.bias"
    ],
    "lr_scale": 1.0
  },
  "layer_13_decay": {
    "weight_decay": 0.05,
    "params": [
      "head.weight"
    ],
    "lr_scale": 1.0
  }
}
[2023-07-14 15:54:17,363] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed info: version=0.5.8, git-hash=unknown, git-branch=unknown
[2023-07-14 15:54:17,372] [INFO] [logging.py:69:log_dist] [Rank 0] initializing deepspeed groups
[2023-07-14 15:54:17,372] [INFO] [logging.py:69:log_dist] [Rank 0] initializing deepspeed model parallel group with size 1
[2023-07-14 15:54:17,373] [INFO] [logging.py:69:log_dist] [Rank 0] initializing deepspeed expert parallel group with size 1
[2023-07-14 15:54:17,373] [INFO] [logging.py:69:log_dist] [Rank 0] creating expert data parallel process group with ranks: [0]
[2023-07-14 15:54:17,373] [INFO] [logging.py:69:log_dist] [Rank 0] creating expert parallel process group with ranks: [0]
[2023-07-14 15:54:17,654] [INFO] [engine.py:278:__init__] DeepSpeed Flops Profiler Enabled: False
Installed CUDA version 11.4 does not match the version torch was compiled with 11.1 but since the APIs are compatible, accepting this combination
Using /root/.cache/torch_extensions/py38_cu111 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /root/.cache/torch_extensions/py38_cu111/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.9816381931304932 seconds
[2023-07-14 15:54:19,600] [INFO] [engine.py:1108:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2023-07-14 15:54:19,608] [INFO] [engine.py:1116:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2023-07-14 15:54:19,608] [INFO] [logging.py:69:log_dist] [Rank 0] Creating fp16 optimizer with dynamic loss scale
[2023-07-14 15:54:19,618] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2023-07-14 15:54:19,619] [INFO] [engine.py:808:_configure_lr_scheduler] DeepSpeed using client LR scheduler
[2023-07-14 15:54:19,619] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2023-07-14 15:54:19,619] [INFO] [logging.py:69:log_dist] [Rank 0] step=0, skipped=0, lr=[0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001], mom=[[0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999], [0.9, 0.999]]
[2023-07-14 15:54:19,619] [INFO] [config.py:1059:print] DeepSpeedEngine configuration:
[2023-07-14 15:54:19,619] [INFO] [config.py:1063:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-07-14 15:54:19,619] [INFO] [config.py:1063:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   amp_enabled .................. False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   amp_params ................... False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": null, 
    "exps_dir": null, 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   bfloat16_enabled ............. False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   checkpoint_tag_validation_enabled  True
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   checkpoint_tag_validation_fail  False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   communication_data_type ...... None
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   curriculum_enabled ........... False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   curriculum_params ............ False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   dataloader_drop_last ......... False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   disable_allgather ............ False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   dump_state ................... False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   dynamic_loss_scale_args ...... {'init_scale': 128, 'scale_window': 128, 'delayed_shift': 2, 'min_scale': 1}
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   eigenvalue_enabled ........... False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   eigenvalue_gas_boundary_resolution  1
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   eigenvalue_layer_num ......... 0
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   eigenvalue_max_iter .......... 100
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   eigenvalue_stability ......... 1e-06
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   eigenvalue_tol ............... 0.01
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   eigenvalue_verbose ........... False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   elasticity_enabled ........... False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   fp16_enabled ................. True
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   fp16_master_weights_and_gradients  False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   fp16_mixed_quantize .......... False
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   global_rank .................. 0
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   gradient_accumulation_steps .. 4
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   gradient_clipping ............ 0.0
[2023-07-14 15:54:19,620] [INFO] [config.py:1063:print]   gradient_predivide_factor .... 1.0
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   initial_dynamic_scale ........ 128
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   loss_scale ................... 0
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   memory_breakdown ............. False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   optimizer_legacy_fusion ...... False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   optimizer_name ............... adam
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   optimizer_params ............. {'lr': 0.001, 'weight_decay': 0.05, 'bias_correction': True, 'betas': [0.9, 0.999], 'eps': 1e-08}
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   pld_enabled .................. False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   pld_params ................... False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   prescale_gradients ........... False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   quantize_change_rate ......... 0.001
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   quantize_groups .............. 1
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   quantize_offset .............. 1000
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   quantize_period .............. 1000
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   quantize_rounding ............ 0
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   quantize_start_bits .......... 16
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   quantize_target_bits ......... 8
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   quantize_training_enabled .... False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   quantize_type ................ 0
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   quantize_verbose ............. False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   scheduler_name ............... None
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   scheduler_params ............. None
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   sparse_attention ............. None
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   sparse_gradients_enabled ..... False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   steps_per_print .............. 1000
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   tensorboard_enabled .......... False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   tensorboard_job_name ......... DeepSpeedJobName
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   tensorboard_output_path ...... 
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   train_batch_size ............. 16
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   train_micro_batch_size_per_gpu  4
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   use_quantizer_kernel ......... False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   wall_clock_breakdown ......... False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   world_size ................... 1
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   zero_allow_untested_optimizer  False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": true, 
    "reduce_scatter": true, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+09, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true, 
    "round_robin_gradients": false, 
    "legacy_stage1": false
}
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   zero_enabled ................. False
[2023-07-14 15:54:19,621] [INFO] [config.py:1063:print]   zero_optimization_stage ...... 0
[2023-07-14 15:54:19,621] [INFO] [config.py:1065:print]   json = {
    "train_batch_size": 16, 
    "train_micro_batch_size_per_gpu": 4, 
    "steps_per_print": 1000, 
    "optimizer": {
        "type": "Adam", 
        "adam_w_mode": true, 
        "params": {
            "lr": 0.001, 
            "weight_decay": 0.05, 
            "bias_correction": true, 
            "betas": [0.9, 0.999], 
            "eps": 1e-08
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 7, 
        "loss_scale_window": 128
    }
}
Using /root/.cache/torch_extensions/py38_cu111 as PyTorch extensions root...
Emitting ninja build file /root/.cache/torch_extensions/py38_cu111/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.9622378349304199 seconds
model.gradient_accumulation_steps() = 4
Use step level LR scheduler!
Set warmup steps = 0
Set warmup steps = 0
Max WD = 0.0500000, Min WD = 0.0500000
criterion = SoftTargetCrossEntropy()
Start training for 150 epochs
Epoch: [0]  [    0/60301]  eta: 2 days, 13:33:08  lr: 0.000063  min_lr: 0.000001  loss: 5.9922 (5.9922)  loss_scale: 128.0000 (128.0000)  weight_decay: 0.0500 (0.0500)  time: 3.6747  data: 3.2885  max mem: 8117
Epoch: [0]  [   10/60301]  eta: 13:39:59  lr: 0.000063  min_lr: 0.000001  loss: 5.9921 (5.9921)  loss_scale: 128.0000 (128.0000)  weight_decay: 0.0500 (0.0500)  time: 0.8160  data: 0.4827  max mem: 8160
Epoch: [0]  [   20/60301]  eta: 12:45:45  lr: 0.000063  min_lr: 0.000001  loss: 5.9921 (5.9920)  loss_scale: 128.0000 (128.0000)  weight_decay: 0.0500 (0.0500)  time: 0.6166  data: 0.2617  max mem: 8160
